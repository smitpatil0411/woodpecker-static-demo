kind: pipeline
type: docker
name: default

steps:
  - name: validate
    image: alpine:3.20
    commands:
      - echo "Validating repo contents..."
      - test -f site/index.html
      - test -f site/styles.css

  - name: build
    image: node:20-alpine
    commands:
      - echo "Pretend build: copy static files to dist/"
      - mkdir -p dist
      - cp -r site/* dist/
      - ls -la dist

  - name: test
    image: alpine:3.20
    commands:
      - echo "Run a simple test..."
      - grep -q "Hello Woodpecker" dist/index.html
      - echo "All good!"

  - name: package
    image: alpine:3.20
    commands:
      - tar -czf dist.tar.gz dist
      - ls -lh dist.tar.gz
